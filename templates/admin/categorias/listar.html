<script>
/**
 * Lida com o clique no botão de exclusão.
 * Usa os atributos data-* definidos no HTML.
 */
document.addEventListener('click', function (event) {
    const btn = event.target.closest('.btn-excluir');
    if (!btn) return;

    const id = btn.dataset.id;
    const nome = btn.dataset.nome;
    const descricao = btn.dataset.descricao;

    const texto = `
        <strong>${nome}</strong> será removida permanentemente.<br>
        <em>Descrição:</em> ${descricao ? descricao : '-'}
    `;
    document.getElementById('textoConfirmacao').innerHTML = texto;

    const btnConfirmar = document.getElementById('btnConfirmarExclusao');
    btnConfirmar.dataset.categoriaId = id;

    const modal = new bootstrap.Modal(document.getElementById('modalConfirmDelete'));
    modal.show();
});

/**
 * Executa a exclusão quando o usuário confirma.
 */
document.getElementById('btnConfirmarExclusao').addEventListener('click', function () {
    const id = this.dataset.categoriaId;
    if (!id) return;

    fetch(`/admin/categorias/excluir/${id}`, {
        method: 'POST',
        headers: {
            'X-CSRFToken': '{{ csrf_token() }}'  // opcional, se você usa CSRF
        }
    })
    .then(res => {
        if (res.ok) location.reload();
        else return res.text().then(txt => Promise.reject(txt));
    })
    .catch(err => alert('Erro ao excluir a categoria: ' + err));
});
</script>
